{% extends "base.html" %}

{% block content %}
<h1>Data Page</h1>
<p>This is the Data page.</p>

<div class="row">
    <div class="col-12 mb-3">
        <div class="card text-white bg-dark mb-3">
            <div class="card-body">
                <h5 class="card-title">Table Data Actual</h5>
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="thead-dark">
                            <tr>
                                <th scope="col">DATE</th>
                                <th scope="col">Actual Value</th>
                            </tr>
                        </thead>
                        <tbody id="actualDataTableBody">
                            <!-- Data tabel akan diisi oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-4 col-md-6 col-12 mb-3">
        <div class="card text-white bg-dark mb-3">
            <div class="card-body">
                <h5 class="card-title">Model Evaluation</h5>
                <ul id="modelEvaluation">
                    <!-- Data evaluasi model akan diisi oleh JavaScript -->
                </ul>
            </div>
        </div>
    </div>

    <div class="col-lg-4 col-md-6 col-12 mb-3">
        <div class="card bg-dark mb-3">
            <div class="card-body">
                <h5 class="card-title text-white">Summary Forecast Data</h5>
                <ul class="list-group" id="summaryForecastData">
                    <!-- Data summary forecast akan diisi oleh JavaScript -->
                </ul>
            </div>
        </div>
    </div>

    <div class="col-lg-4 col-md-6 col-12 mb-3">
        <div class="card bg-dark mb-3">
            <div class="card-body">
                <h5 class="card-title text-white">Summary Actual Data</h5>
                <ul class="list-group" id="summaryActualData">
                    <!-- Data summary actual akan diisi oleh JavaScript -->
                </ul>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Fetch actual data and populate table
        fetch("/actual_data")
            .then((response) => response.json())
            .then((data) => {
                const actualDataTableBody = document.getElementById("actualDataTableBody");
                data.forEach((item) => {
                    const row = document.createElement("tr");
                    row.innerHTML = `
                        <td>${formatDate(item.ds)}</td>
                        <td>${item.y.toFixed(2)}</td>
                    `;
                    actualDataTableBody.appendChild(row);
                });
            });
    
        // Example model evaluation data
        const evaluationData = {
            MAE: 1578.56,
            MSE: 3838672.87,
            MAPE: "8.70%",
            RMSE: 1970.70
        };
    
        // Populate model evaluation section
        const modelEvaluation = document.getElementById("modelEvaluation");
        for (let key in evaluationData) {
            const li = document.createElement("li");
            li.textContent = `${key}: ${evaluationData[key]}`;
            modelEvaluation.appendChild(li);
        }
    
        // Example summary data
        const summaryForecast = {
            Minimum: 15696.31,
            Maximum: 30259.13,
            Average: 19999.69
        };
    
        const summaryActual = {
            Minimum: 15696.31,
            Maximum: 30259.13,
            Average: 19999.69
        };
    
        // Populate summary forecast data section
        const summaryForecastData = document.getElementById("summaryForecastData");
        for (let key in summaryForecast) {
            const li = document.createElement("li");
            li.classList.add("list-group-item");
            li.innerHTML = `<label>${key}:</label> <span>${summaryForecast[key]} GJ</span>`;
            summaryForecastData.appendChild(li);
        }
    
        // Populate summary actual data section
        const summaryActualData = document.getElementById("summaryActualData");
        for (let key in summaryActual) {
            const li = document.createElement("li");
            li.classList.add("list-group-item");
            li.innerHTML = `<label>${key}:</label> <span>${summaryActual[key]} GJ</span>`;
            summaryActualData.appendChild(li);
        }
    });
    
    function formatDate(dateStr) {
        const date = new Date(dateStr);
        const day = String(date.getDate()).padStart(2, '0');
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const year = date.getFullYear();
        return `${day}-${month}-${year}`;
    }
    </script>    

{% endblock %}
